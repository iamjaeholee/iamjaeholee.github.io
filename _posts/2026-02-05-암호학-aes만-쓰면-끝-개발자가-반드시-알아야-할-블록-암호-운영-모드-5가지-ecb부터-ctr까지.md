---layout: posttitle: "[μ•”νΈν•™] AESλ§ μ“°λ©΄ λ? κ°λ°μκ°€ λ°λ“μ‹ μ•μ•„μ•Ό ν•  λΈ”λ΅ μ•”νΈ μ΄μ λ¨λ“ 5κ°€μ§€ (ECBλ¶€ν„° CTRκΉμ§€)"date: 2026-02-05 07:25:31 +0000
categories: [Velog]---<p>&quot;DB μ•”νΈν™”λ” AES-256μΌλ΅ ν•μ„Έμ”.&quot;
μ‹ μ… μ‹μ  μ΄λ° μ§€μ‹λ¥Ό λ°›μΌλ©΄ μ°λ¦¬λ” λ³΄ν†µ κµ¬κΈ€λ§μ„ ν•΄μ„ μ½”λ“λ¥Ό λ³µμ‚¬ν•΄ μµλ‹λ‹¤. κ·Έλ°λ° <code>Cipher.getInstance()</code> μ•μ— λ“¤μ–΄κ°€λ” λ¬Έμμ—΄μ΄ λ¬ν•κ² λ‹¤λ¦…λ‹λ‹¤.</p>
<ul>
<li><code>AES/ECB/PKCS5Padding</code> (?)</li>
<li><code>AES/CBC/PKCS5Padding</code> (?)</li>
<li><code>AES/GCM/NoPadding</code> (?)</li>
</ul>
<p>&quot;κ·Έλƒ¥ AESλ©΄ AESμ§€ λ’¤μ— λ¶™μ€ μ € μμ–΄λ“¤μ€ λ‹¤ λ­μ§€?&quot;
μ΄ κ¶κΈμ¦μ„ ν•΄κ²°ν•μ§€ μ•κ³  <strong>ECB</strong> κ°™μ€ κ±Έ κ³¨λλ‹¤κ°€λ”, μ•”νΈν™”λ¥Ό ν–λ”λ°λ„ λ°μ΄ν„° ν¨ν„΄μ΄ ν›¤ν λ³΄μ΄λ” λ€μ°Έμ‚¬κ°€ μΌμ–΄λ‚©λ‹λ‹¤. μ¤λμ€ μ•”νΈν•™μ μ‹¬μ¥λ¶€μΈ <strong>&#39;λΈ”λ΅ μ•”νΈ μ΄μ λ¨λ“&#39;</strong>λ¥Ό κ°λ°μμ μ–Έμ–΄μΈ <strong>μ½”λ“</strong>λ΅ νν—¤μ³ λ΄…λ‹λ‹¤.</p>
<hr>
<h2 id="1-κΈ°μ΄-λ‹¤μ§€κΈ°-μ™-ν•ν•„-xorμΈκ°€">1. κΈ°μ΄ λ‹¤μ§€κΈ°: μ™ ν•ν•„ XOR()μΈκ°€?</h2>
<p>λ¨λ“  μ•”νΈν™” λ¨λ“ μ„¤λ…μ„ λ³΄λ©΄ <code>XOR</code> μ—°μ‚°μ΄ λΉ μ§€μ§€ μ•μµλ‹λ‹¤. λ§μ…(+)λ„ μκ³  κ³±μ…(*)λ„ μλ”λ° μ™ ν•ν•„ XORμΌκΉμ”? μ—¬κΈ°μ—” κ²°μ •μ μΈ μ΄μ  3κ°€μ§€κ°€ μμµλ‹λ‹¤.</p>
<ol>
<li><strong>μ™„λ²½ν• λ³µκµ¬ (κ°€μ—­μ„±)</strong>: <code>A</code>μ— <code>Key</code>λ¥Ό XOR ν•΄μ„ μ•”νΈν™”ν–λ‹¤λ©΄, κ²°κ³Όλ¬Όμ— λ‹¤μ‹ <code>Key</code>λ¥Ό XOR ν•λ©΄ μ™„λ²½ν•κ² <code>A</code>λ΅ λμ•„μµλ‹λ‹¤.</li>
</ol>
<ul>
<li><code>A β• Key = Cipher</code></li>
<li><code>Cipher β• Key = A</code></li>
</ul>
<ol start="2">
<li><strong>50:50μ λ§λ²• (Diffusing)</strong>: μ–΄λ–¤ λ°μ΄ν„°λ“  λλ¤ν• ν‚¤μ™€ XORμ„ ν•λ©΄, κ²°κ³Όκ°’μ 0κ³Ό 1 λ¶„ν¬κ°€ λ°λ°μ΄ λ©λ‹λ‹¤. μ¦‰, <strong>λ°μ΄ν„°μ ν”μ μ„ μ§€μ°λ” κ°€μ¥ ν¨μ¨μ μΈ λ°©λ²•</strong>μ…λ‹λ‹¤.</li>
<li><strong>μ••λ„μ μΈ μ†λ„</strong>: CPU μ…μ¥μ—μ„ κ°€μ¥ λΉ„μ©μ΄ μ €λ ΄ν•κ³  λΉ λ¥Έ μ—°μ‚°μ…λ‹λ‹¤.</li>
</ol>
<p>μ΄ XORμ„ <strong>&quot;μ–΄λ–¤ νƒ€μ΄λ°μ—, λ¬΄μ—‡κ³Ό μ„λλƒ&quot;</strong>μ— λ”°λΌ μ•„λμ μ΄μ λ¨λ“λ“¤μ΄ λ‚λ‰©λ‹λ‹¤.</p>
<hr>
<h2 id="2-μµμ•…μ-μ„ νƒ-ecb-electronic-codebook">2. μµμ•…μ μ„ νƒ: ECB (Electronic Codebook)</h2>
<p>κ°€μ¥ λ‹¨μν• &quot;λ¶•μ–΄λΉµ ν‹€&quot; λ°©μ‹μ…λ‹λ‹¤. λ°μ΄ν„°λ¥Ό λΈ”λ΅(16λ°”μ΄νΈ)μΌλ΅ μλ¥΄κ³ , λ£¨ν”„λ¥Ό λλ©° κ°κ° λ…λ¦½μ μΌλ΅ μ•”νΈν™”ν•©λ‹λ‹¤.</p>
<h3 id="π’»-μ½”λ“-λ΅μ§-pseudo-code">π’» μ½”λ“ λ΅μ§ (Pseudo-code)</h3>
<pre><code class="language-python">def encrypt_ecb(plain_blocks, key):
    cipher_text = &quot;&quot;
    # κ° λΈ”λ΅μ΄ μ„λ΅ λ‚¨λ‚¨μ…λ‹λ‹¤. (λ…λ¦½μ )
    for block in plain_blocks:
        cipher_text += AES_encrypt(block, key) 
    return cipher_text
</code></pre>
<h3 id="β-μΉλ…μ -λ‹¨μ -ν¨ν„΄-λ…Έμ¶">β μΉλ…μ  λ‹¨μ : ν¨ν„΄ λ…Έμ¶</h3>
<p>μ…λ ¥κ°’μ΄ κ°™μΌλ©΄ μ¶λ ¥κ°’λ„ λ¬΄μ΅°κ±΄ κ°™μµλ‹λ‹¤. μ΄λ―Έμ§€ λ“±μ„ μ•”νΈν™”ν–μ„ λ• <strong>ν•μ²΄κ°€ κ·Έλ€λ΅ λ‚¨λ” μΉλ…μ μΈ μ·¨μ•½μ </strong>μ΄ μμµλ‹λ‹¤.
λ°±λ¬Έμ΄ λ¶μ—¬μΌκ²¬, μ•„λ μμƒμ„ λ³΄μ‹λ©΄ ECBκ°€ μ™ μ„ν—ν•μ§€ λ°”λ΅ μ΄ν•΄λμ‹¤ κ²λ‹λ‹¤.</p>
<p><a href="https://www.youtube.com/watch?v=oYUd4MrGEf0">The ECB Penguin - Visualizing Encryption</a></p>
<blockquote>
<p><strong>μ‹¤λ¬΄ μ›μΉ™ 1</strong>: <code>AES/ECB</code>λ” λ³΄μ• μ·¨μ•½μ μ΄λ―€λ΅ μ λ€ μ‚¬μ©ν•μ§€ λ§μ„Έμ”.</p>
</blockquote>
<hr>
<h2 id="3-μ‚¬μ¬μ²λΌ-μ—®λ‹¤-cbc-cipher-block-chaining">3. μ‚¬μ¬μ²λΌ μ—®λ‹¤: CBC (Cipher Block Chaining)</h2>
<p>ECBμ λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ <strong>&quot;μ• λΈ”λ΅μ κ²°κ³Όλ¬Όμ„ λ‹¤μ λΈ”λ΅μ— μ„λ”(XOR)&quot;</strong> λ°©μ‹μ…λ‹λ‹¤. κ°€μ¥ μ¤λ«λ™μ• ν‘μ¤€μΌλ΅ μ“°μ€μµλ‹λ‹¤.</p>
<h3 id="π’»-μ½”λ“-λ΅μ§-pseudo-code-1">π’» μ½”λ“ λ΅μ§ (Pseudo-code)</h3>
<pre><code class="language-python">def encrypt_cbc(plain_blocks, key, iv):
    cipher_text = &quot;&quot;
    prev_cipher = iv  # μ²« μ‹μ‘μ€ μ΄κΈ°ν™” λ²΅ν„°(IV)

    for block in plain_blocks:
        # 1. μ•”νΈν™”ν•κΈ° μ „μ— &#39;μ΄μ „ μ•”νΈλ¬Έ&#39;μ΄λ‘ μ„μ–΄λ²„λ¦Ό (XOR)
        mixed_block = xor(block, prev_cipher)

        # 2. μ„μΈ κ±Έ μ•”νΈν™”
        current_cipher = AES_encrypt(mixed_block, key)

        cipher_text += current_cipher
        prev_cipher = current_cipher  # ν„μ¬ κ²°κ³Όκ°€ λ‹¤μμ μ¬λ£κ°€ λ¨
    return cipher_text
</code></pre>
<h3 id="β…-νΉμ§•">β… νΉμ§•</h3>
<ul>
<li><strong>μμ‹</strong>: </li>
<li><strong>μ¥μ </strong>: κ°™μ€ &quot;Hello&quot;λΌλ„, μ•μ λ‚΄μ©μ΄ λ‹¤λ¥΄λ©΄ κ²°κ³Όκ°€ μ™„μ „ν λ‹¬λΌμ§‘λ‹λ‹¤. (ν¨ν„΄ νκ΄΄)</li>
<li><strong>λ‹¨μ </strong>: <code>prev_cipher</code>κ°€ λ‚μ™€μ•Ό λ‹¤μ λ£¨ν”„λ¥Ό λ μ μμ–΄μ„ <strong>λ³‘λ ¬ μ²λ¦¬(μ†λ„)</strong>κ°€ λλ¦½λ‹λ‹¤.</li>
</ul>
<hr>
<h2 id="4-ν•µμ‹¬-μ™-cfb-ofb-ctrμ€-μ¤νΈλ¦ΌstreamμΈκ°€">4. [ν•µμ‹¬] μ™ CFB, OFB, CTRμ€ &#39;μ¤νΈλ¦Ό(Stream)&#39;μΈκ°€?</h2>
<p>μ—¬κΈ°μ„λ¶€ν„°κ°€ μ§„μ§μ…λ‹λ‹¤. μ΄ μ„Έ κ°€μ§€ λ¨λ“λ” <strong>λΈ”λ΅ μ•”νΈ(AES)</strong>λ¥Ό μ‚¬μ©ν•μ§€λ§ λ™μ‘ λ°©μ‹μ€ <strong>μ¤νΈλ¦Ό μ•”νΈ</strong>μ…λ‹λ‹¤. κ·Έ μ΄μ λ” <strong>&quot;λ°μ΄ν„°λ¥Ό μ§μ ‘ μ•”νΈν™”ν•μ§€ μ•κΈ° λ•λ¬Έ&quot;</strong>μ…λ‹λ‹¤.</p>
<h3 id="π-μ¤νΈλ¦Ό-λ¨λ“μ-κ³µν†µ-μ›λ¦¬-ν‚¤-μ¤νΈλ¦Όkey-stream">π μ¤νΈλ¦Ό λ¨λ“μ κ³µν†µ μ›λ¦¬: &quot;ν‚¤ μ¤νΈλ¦Ό(Key Stream)&quot;</h3>
<ol>
<li>μ•”νΈν™” μ—”μ§„(AES)μ€ ν‰λ¬Έμ„ κ±΄λ“λ¦¬μ§€ μ•κ³ , μ§€ νΌμ λλ©΄μ„ <strong>&#39;μΌνμ© μ•”νΈ ν‚¤(Key Stream)&#39;</strong>λ¥Ό κ³„μ† μƒμ„±ν•©λ‹λ‹¤.</li>
<li>λ°μ΄ν„°(ν‰λ¬Έ)λ” κ·Έμ € μƒμ„±λ ν‚¤μ™€ <strong>XOR()</strong>λ§ ν•λ©΄ λμ…λ‹λ‹¤.</li>
</ol>
<h3 id="π€-μ¤νΈλ¦Όμ΄λΌμ„-μΆ‹μ€-μ ">π€ μ¤νΈλ¦Όμ΄λΌμ„ μΆ‹μ€ μ </h3>
<ol>
<li><strong>ν¨λ”©(Padding) λ¶ν•„μ”</strong>: XORλ§ ν•λ©΄ λλ‹κΉ λ°μ΄ν„° κΈΈμ΄λ¥Ό 16λ°”μ΄νΈλ΅ μ–µμ§€λ΅ λ§μ¶ ν•„μ”κ°€ μ—†μµλ‹λ‹¤.</li>
<li><strong>μ‹¤μ‹κ°„μ„±</strong>: 1λΉ„νΈ, 1λ°”μ΄νΈλ§ λ“¤μ–΄μ™€λ„ λ°”λ΅λ°”λ΅ μ•”νΈν™”ν•΄μ„ μ  μ μμµλ‹λ‹¤. (μμƒ ν†µν™”, μ±„ν…μ— μ λ¦¬)</li>
</ol>
<hr>
<h2 id="5-μ¤νΈλ¦Ό-3ν•μ -μ½”λ“-λΉ„κµ">5. μ¤νΈλ¦Ό 3ν•μ  μ½”λ“ λΉ„κµ</h2>
<h3 id="β‘ -cfb-cipher-feedback-μ•”νΈλ¬Έ-κΌ¬λ¦¬-λ¬ΌκΈ°">β‘  CFB (Cipher Feedback): μ•”νΈλ¬Έ κΌ¬λ¦¬ λ¬ΌκΈ°</h3>
<p>μ΄μ „ λ‹¨κ³„μ <strong>&#39;μ•”νΈλ¬Έ&#39;</strong>μ„ λ‹¤μ‹ μ•”νΈν™” μ—”μ§„μ— λ„£μ–΄ ν‚¤λ¥Ό λ§λ“­λ‹λ‹¤.</p>
<pre><code class="language-python">def encrypt_cfb(plain_blocks, key, iv):
    feedback = iv
    for block in plain_blocks:
        # 1. &#39;μ΄μ „ μ•”νΈλ¬Έ(feedback)&#39;μ„ μ•”νΈν™”ν•΄μ„ ν‚¤λ¥Ό λ§λ“¦
        key_stream = AES_encrypt(feedback, key)

        # 2. λ°μ΄ν„°μ™€ ν‚¤λ¥Ό XOR
        cipher_block = xor(block, key_stream)

        # 3. μ•”νΈλ¬Έμ„ λ‹¤μ λ‹¨κ³„λ΅ μ „λ‹¬ (μ¤λ¥ μ „ν λ°μƒ!)
        feedback = cipher_block 
</code></pre>
<ul>
<li><strong>νΉμ§•</strong>: μ „μ†΅ μ¤‘ μ•”νΈλ¬Έμ΄ κΉ¨μ§€λ©΄ λ‹¤μ λ‹¨κ³„μ ν‚¤ μƒμ„± μ¬λ£(<code>feedback</code>)κ°€ μ¤μ—Όλλ―€λ΅ <strong>λ‹¤μ λΈ”λ΅κΉμ§€ μ—λ¬κ°€ μ „ν</strong>λ©λ‹λ‹¤.</li>
</ul>
<h3 id="β‘΅-ofb-output-feedback-λ‚-ν™€λ΅-μ—”μ§„">β‘΅ OFB (Output Feedback): λ‚ ν™€λ΅ μ—”μ§„</h3>
<p>μ•”νΈν™” μ—”μ§„μ <strong>&#39;μ¶λ ¥κ°’&#39;</strong>μ„ λ‹¤μ‹ μ…λ ¥μΌλ΅ λ„£μµλ‹λ‹¤. ν‰λ¬Έ/μ•”νΈλ¬Έμ€ ν‚¤ μƒμ„±μ— κ΄€μ—¬ν•μ§€ μ•μµλ‹λ‹¤.</p>
<pre><code class="language-python">def encrypt_ofb(plain_blocks, key, iv):
    output = iv
    for block in plain_blocks:
        # 1. μ—”μ§„ μ¶λ ¥κ°’(output)μ„ λ‹¤μ‹ μ•”νΈν™”ν•΄μ„ ν‚¤λ¥Ό λ§λ“¦
        output = AES_encrypt(output, key)
        key_stream = output

        # 2. λ°μ΄ν„°μ™€ ν‚¤λ¥Ό XOR
        # ν‰λ¬Έμ΄ κΉ¨μ Έλ„ ν‚¤ μƒμ„±(output)μ—” μν–¥ μ—†μ -&gt; μ¤λ¥ μ „ν μ• λ¨
        cipher_block = xor(block, key_stream)
</code></pre>
<ul>
<li><strong>νΉμ§•</strong>: μ „μ†΅ μ—λ¬κ°€ λ°μƒν•΄λ„ ν•΄λ‹Ή λΉ„νΈλ§ κΉ¨μ§€κ³  λ‚λ¨Έμ§€λ” λ©€μ©΅ν•©λ‹λ‹¤. (μμƒ μ¤νΈλ¦¬λ° λ“±μ— μ λ¦¬)</li>
</ul>
<h3 id="β‘Ά-ctr-counter-μ†λ„μ-μ μ™•-ν„λ€-ν‘μ¤€">β‘Ά CTR (Counter): μ†λ„μ μ μ™• (ν„λ€ ν‘μ¤€)</h3>
<p>λ°μ΄ν„°μ™€ μƒκ΄€μ—†μ΄, 1μ”© μ¦κ°€ν•λ” <strong>&#39;μΉ΄μ΄ν„°(μ«μ)&#39;</strong>λ¥Ό μ•”νΈν™”ν•΄μ„ ν‚¤λ¥Ό λ§λ“­λ‹λ‹¤.</p>
<pre><code class="language-python">def encrypt_ctr(plain_blocks, key, nonce):
    # forλ¬Έ μμ„ μƒκ΄€ μ—†μ! (λ³‘λ ¬ μ²λ¦¬ κ°€λ¥)
    for i, block in enumerate(plain_blocks):
        counter = nonce + i

        # 1. μ«μλ¥Ό μ•”νΈν™”ν•΄μ„ ν‚¤λ¥Ό λ§λ“¦
        key_stream = AES_encrypt(counter, key)

        # 2. λ°μ΄ν„°μ™€ ν‚¤λ¥Ό XOR
        cipher_block = xor(block, key_stream)
</code></pre>
<ul>
<li><strong>νΉμ§•</strong>: κ° λΈ”λ΅μ΄ μ„λ΅ λ…λ¦½μ (Independant)μ…λ‹λ‹¤. λ©€ν‹°μ½”μ–΄ CPUλ΅ λ™μ‹μ— μ•”νΈν™”ν•  μ μμ–΄ <strong>μ†λ„κ°€ λ§¤μ° λΉ λ¦…λ‹λ‹¤.</strong></li>
</ul>
<hr>
<h2 id="6-κ²°λ΅ -κ°λ°μμ-μ„ νƒ-κ°€μ΄λ“">6. κ²°λ΅ : κ°λ°μμ μ„ νƒ κ°€μ΄λ“</h2>
<table>
<thead>
<tr>
<th>μƒν™©</th>
<th>μ¶”μ² λ¨λ“</th>
<th>μ΄μ </th>
</tr>
</thead>
<tbody><tr>
<td><strong>ν„λ€μ  ν‘μ¤€ (Best)</strong></td>
<td><strong>GCM</strong></td>
<td><strong>CTR λ¨λ“</strong>λ¥Ό κΈ°λ°μΌλ΅ ν•μ—¬ μ†λ„κ°€ λΉ λ¥΄κ³ (λ³‘λ ¬), λ°μ΄ν„° μ„λ³€μ΅° κ²€μ‚¬(μΈμ¦)κΉμ§€ ν•΄μ¤.</td>
</tr>
<tr>
<td><strong>λ κ±°μ‹ νΈν™</strong></td>
<td><strong>CBC</strong></td>
<td>μμ „ μ‹μ¤ν…κ³Ό ν†µμ‹ ν•΄μ•Ό ν•λ‹¤λ©΄ μ‚¬μ©. (λ‹¨, μ†λ„λ” μΆ€ λλ¦Ό)</td>
</tr>
<tr>
<td><strong>μ λ€ κΈμ§€</strong></td>
<td><strong>ECB</strong></td>
<td>λ³΄μ•μ„±μ΄ μ—†μ. ν…μ¤νΈ μ©λ„λ΅λ§ μ“Έ κ²ƒ.</td>
</tr>
</tbody></table>
<p>μ΄μ  μλ°”λ‚ νμ΄μ¬μ—μ„ <code>AES/GCM/NoPadding</code>μ΄λΌλ” μ½”λ“λ¥Ό λ³΄λ©΄ <strong>&quot;μ•„, μΉ΄μ΄ν„°λ΅ ν‚¤ μ¤νΈλ¦Όμ„ λ§λ“¤μ–΄μ„ XOR ν•λ‹κΉ ν¨λ”©μ΄ ν•„μ” μ—†κ³  λΉ λ¥΄κµ¬λ‚!&quot;</strong>λΌκ³  μ΄ν•΄ν•μ‹λ©΄ λ©λ‹λ‹¤.</p>
